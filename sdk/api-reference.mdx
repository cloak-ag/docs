---
title: "API reference"
description: "Current public API for @cloak.ag/sdk v2"
icon: "code"
---

This page tracks the current exports in `sdk/src/index.ts`.

## Main client: `CloakSDK`

### Constructor

```typescript
new CloakSDK({
  keypairBytes?: Uint8Array;
  wallet?: WalletAdapter;
  network?: "localnet" | "devnet" | "mainnet" | "testnet";
  cloakKeys?: CloakKeyPair;
  storage?: StorageAdapter;
  programId?: PublicKey;
  relayUrl?: string;
  debug?: boolean;
})
```

At least one signer path is required: `keypairBytes` or `wallet`.

### Core methods

```typescript
sdk.deposit(connection, amountOrNote, options?) => Promise<DepositResult>
sdk.withdraw(connection, note, recipient, options?) => Promise<TransferResult>
sdk.send(connection, note, recipients, options?) => Promise<TransferResult>
sdk.swap(connection, note, recipient, options) => Promise<SwapResult>
```

Also available:

```typescript
sdk.privateTransfer(connection, note, recipients, options?)
sdk.generateNote(amountLamports, useWalletKeys?)
sdk.getMerkleProof(connection, leafIndex)
sdk.getCurrentRoot(connection)
sdk.getTransactionStatus(requestId)
```

Storage/key helpers on the class:

```typescript
sdk.loadNotes()
sdk.saveNote(note)
sdk.findNote(commitment)
sdk.importWalletKeys(keysJson)
sdk.exportWalletKeys()
sdk.getConfig()
```

## Note API types

```typescript
type DepositResult = {
  note: CloakNote;
  signature: string;
  leafIndex: number;
  root: string;
};

type TransferResult = {
  signature: string;
  outputs: Array<{ recipient: string; amount: number }>;
  nullifier: string;
  root: string;
};
```

## UTXO API (v2)

Exports from `core/utxo.ts` and `core/transact.ts`:

```typescript
transact(params, options)
transfer(inputUtxos, recipientPubkey, amount, options)
partialWithdraw(inputUtxos, recipient, withdrawAmount, options)
fullWithdraw(inputUtxos, recipient, options)
swapUtxo(params, options)
swapWithChange(inputUtxos, swapAmount, outputMint, recipientAta, minOutputAmount, options, recipientWallet?)
```

UTXO primitives:

```typescript
generateUtxoKeypair()
createUtxo(amount, keypair, mint?)
createZeroUtxo(mint?)
computeUtxoCommitment(utxo)
computeUtxoNullifier(utxo)
```

Full flow guide: [UTXO Transactions (v2)](/sdk/utxo-transactions)

## Relay and proof utilities

```typescript
new RelayService(baseUrl)
relay.submitWithdraw(...)
relay.submitSwap(...)
relay.getStatus(requestId)
relay.resumeWithdraw(requestId)

computeProofFromChain(connection, merkleTreePDA, leafIndex)
readMerkleTreeState(connection, merkleTreePDA)
buildMerkleTreeFromRelay(relayUrl)
```

## Fee constants

```typescript
FIXED_FEE_LAMPORTS      // 5_000_000
VARIABLE_FEE_NUMERATOR  // 3
VARIABLE_FEE_DENOMINATOR// 1000
MIN_DEPOSIT_LAMPORTS    // 10_000_000
VARIABLE_FEE_RATE       // 0.003

calculateFee(amount: number)
calculateFeeBigint(amount: bigint)
getDistributableAmount(amount: number)
```

## Error utilities

```typescript
CloakError
ShieldPoolErrors
RootNotFoundError
isRootNotFoundError(error)
parseError(error)
parseTransactionError(error)
```

Detailed usage: [Error Handling](/sdk/error-handling)

## Versioned exports

```typescript
VERSION            // "2.0.0"
CLOAK_PROGRAM_ID   // mainnet program constant
```

## Protocol and service docs

- [Protocol Architecture](/protocol/architecture)
- [Shield Pool Program](/protocol/shield-pool)
- [Relay API](/services/relay-api)

## SDK export inventory (CI-checked)

{/* SDK_EXPORTS_START */}
```text sdk-exports
source: ../../sdk/src/index.ts
type:CircuitVerificationResult
type:CloakConfig
type:CloakKeyPair
type:CloakNote
type:CommitmentEntry
type:CommitmentsResponse
type:DepositInstructionParams
type:DepositOptions
type:DepositResult
type:DepositStatus
type:EncryptedNote
type:EncryptedUtxoNote
type:Groth16Proof
type:MasterKey
type:MaxLengthArray
type:MerkleProof
type:MerkleRootResponse
type:Network
type:NoteData
type:OnchainMerkleProof
type:PendingDeposit
type:PendingWithdrawal
type:ProofResult
type:RiskQuoteInstructionResponse
type:ShieldPoolPDAs
type:SpendKey
type:StorageAdapter
type:SwapOptions
type:SwapParams
type:SwapResult
type:TransactOptions
type:TransactParams
type:TransactResult
type:Transfer
type:TransferOptions
type:TransferResult
type:TxStatus
type:Utxo
type:UtxoEncryptedNote
type:UtxoKeypair
type:UtxoSwapParams
type:UtxoSwapResult
type:ViewKey
type:WalletAdapter
type:WithdrawOptions
type:WithdrawRegularInputs
type:WithdrawSwapInputs
value:areCircuitsAvailable
value:bigintToBytes32
value:bigintToHex
value:buildMerkleTree
value:buildMerkleTreeFromRelay
value:buildPublicInputsBytes
value:bytesToHex
value:calculateFee
value:calculateFeeBigint
value:calculateRelayFee
value:cleanupStalePendingOperations
value:clearPendingDeposits
value:clearPendingWithdrawals
value:CLOAK_PROGRAM_ID
value:CloakError
value:CloakSDK
value:computeCommitment
value:computeExtDataHash
value:computeMerkleRoot
value:computeNullifier
value:computeNullifierAsync
value:computeNullifierSync
value:computeOutputsHash
value:computeOutputsHashAsync
value:computeOutputsHashSync
value:computeProofForLatestDeposit
value:computeProofFromChain
value:computeSignature
value:computeSwapOutputsHash
value:computeSwapOutputsHashAsync
value:computeSwapOutputsHashSync
value:computeUtxoCommitment
value:computeUtxoNullifier
value:copyNoteToClipboard
value:createCloakError
value:createDepositInstruction
value:createLogger
value:createUtxo
value:createZeroUtxo
value:DEFAULT_CIRCUITS_URL
value:derivePublicKey
value:deriveSpendKey
value:deriveViewKey
value:deserializeEncryptedNote
value:deserializeUtxo
value:detectNetworkFromRpcUrl
value:downloadNote
value:encodeNoteSimple
value:encryptedNoteFromBase64
value:encryptedNoteToBase64
value:encryptNoteForRecipient
value:encryptUtxoForRecipient
value:ErrorCategory
value:EXPECTED_CIRCUIT_HASHES
value:exportKeys
value:exportNote
value:exportWalletKeys
value:fetchCommitments
value:fetchRiskQuoteInstruction
value:filterNotesByNetwork
value:filterWithdrawableNotes
value:findNoteByCommitment
value:FIXED_FEE_LAMPORTS
value:formatAmount
value:formatErrorForLogging
value:formatSol
value:fullWithdraw
value:generateCloakKeys
value:generateCommitment
value:generateCommitmentAsync
value:generateMasterSeed
value:generateNote
value:generateNoteFromWallet
value:generateUtxoKeypair
value:generateWithdrawRegularProof
value:generateWithdrawSwapProof
value:getAddressExplorerUrl
value:getCircuitsPath
value:getDefaultCircuitsPath
value:getDistributableAmount
value:getExplorerUrl
value:getMerkleProofFromRelay
value:getNullifierPDA
value:getPendingOperationsSummary
value:getPublicKey
value:getPublicViewKey
value:getRecipientAmount
value:getRpcUrlForNetwork
value:getShieldPoolPDAs
value:getSwapStatePDA
value:getViewKey
value:hasPendingOperations
value:hexToBigint
value:hexToBytes
value:importKeys
value:importWalletKeys
value:isDebugEnabled
value:isRootNotFoundError
value:isValidHex
value:isValidRpcUrl
value:isValidSolanaAddress
value:isWithdrawable
value:isWithdrawAmountSufficient
value:keypairToAdapter
value:LAMPORTS_PER_SOL
value:loadPendingDeposits
value:loadPendingWithdrawals
value:LocalStorageAdapter
value:Logger
value:LogLevel
value:MemoryStorageAdapter
value:MERKLE_TREE_HEIGHT
value:MerkleTree
value:MIN_DEPOSIT_LAMPORTS
value:NATIVE_SOL_MINT
value:parseAmount
value:parseError
value:parseNote
value:parseRelayErrorResponse
value:parseTransactionError
value:partialWithdraw
value:poseidonHash
value:prepareEncryptedOutput
value:prepareEncryptedOutputForRecipient
value:proofToBytes
value:pubkeyToFieldElement
value:pubkeyToLimbs
value:randomBytes
value:randomFieldElement
value:readMerkleTreeState
value:RelayService
value:removePendingDeposit
value:removePendingWithdrawal
value:RootNotFoundError
value:savePendingDeposit
value:savePendingWithdrawal
value:scanEncryptedNotes
value:scanNotesForWallet
value:sdkLogger
value:selectUtxos
value:sendTransaction
value:serializeEncryptedNote
value:serializeNote
value:serializeUtxo
value:setCircuitsPath
value:setDebugMode
value:ShieldPoolErrors
value:signTransaction
value:splitTo2Limbs
value:sumUtxoAmounts
value:swapUtxo
value:swapWithChange
value:transact
value:transfer
value:truncate
value:tryDecryptNote
value:tryDecryptUtxo
value:updateNoteWithDeposit
value:updatePendingDeposit
value:updatePendingWithdrawal
value:UserFriendlyError
value:utxoBigintToBytes32
value:utxoEquals
value:utxoHexToBigint
value:validateDepositParams
value:validateNote
value:validateOutputsSum
value:validateTransfers
value:validateWalletConnected
value:validateWithdrawableNote
value:VARIABLE_FEE_DENOMINATOR
value:VARIABLE_FEE_NUMERATOR
value:VARIABLE_FEE_RATE
value:verifyAllCircuits
value:verifyCircuitIntegrity
value:VERSION
value:WithdrawSubmissionResult
value:withTiming
```
{/* SDK_EXPORTS_END */}
