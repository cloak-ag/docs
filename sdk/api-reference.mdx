---
title: "API reference"
description: "Current public API for @cloak.ag/sdk v2"
icon: "code"
---

This page tracks the current exports in `sdk/src/index.ts`.

## Main client: `CloakSDK`

### Constructor

```typescript
new CloakSDK({
  keypairBytes?: Uint8Array;
  wallet?: WalletAdapter;
  network?: "localnet" | "devnet" | "mainnet" | "testnet";
  cloakKeys?: CloakKeyPair;
  storage?: StorageAdapter;
  programId?: PublicKey;
  relayUrl?: string;
  debug?: boolean;
})
```

At least one signer path is required: `keypairBytes` or `wallet`.

### Core methods

```typescript
sdk.deposit(connection, amountOrNote, options?) => Promise<DepositResult>
sdk.withdraw(connection, note, recipient, options?) => Promise<TransferResult>
sdk.send(connection, note, recipients, options?) => Promise<TransferResult>
sdk.swap(connection, note, recipient, options) => Promise<SwapResult>
```

Also available:

```typescript
sdk.privateTransfer(connection, note, recipients, options?)
sdk.generateNote(amountLamports, useWalletKeys?)
sdk.getMerkleProof(connection, leafIndex)
sdk.getCurrentRoot(connection)
sdk.getTransactionStatus(requestId)
```

Storage/key helpers on the class:

```typescript
sdk.loadNotes()
sdk.saveNote(note)
sdk.findNote(commitment)
sdk.importWalletKeys(keysJson)
sdk.exportWalletKeys()
sdk.getConfig()
```

## Note API types

```typescript
type DepositResult = {
  note: CloakNote;
  signature: string;
  leafIndex: number;
  root: string;
};

type TransferResult = {
  signature: string;
  outputs: Array<{ recipient: string; amount: number }>;
  nullifier: string;
  root: string;
};
```

## UTXO API (v2)

Exports from `core/utxo.ts` and `core/transact.ts`:

```typescript
transact(params, options)
transfer(inputUtxos, recipientPubkey, amount, options)
partialWithdraw(inputUtxos, recipient, withdrawAmount, options)
fullWithdraw(inputUtxos, recipient, options)
swapUtxo(params, options)
swapWithChange(inputUtxos, swapAmount, outputMint, recipientAta, minOutputAmount, options, recipientWallet?)
```

UTXO primitives:

```typescript
generateUtxoKeypair()
createUtxo(amount, keypair, mint?)
createZeroUtxo(mint?)
computeUtxoCommitment(utxo)
computeUtxoNullifier(utxo)
```

Full flow guide: [UTXO Transactions (v2)](/sdk/utxo-transactions)

## Relay and proof utilities

```typescript
new RelayService(baseUrl)
relay.submitWithdraw(...)
relay.submitSwap(...)
relay.getStatus(requestId)
relay.resumeWithdraw(requestId)

computeProofFromChain(connection, merkleTreePDA, leafIndex)
readMerkleTreeState(connection, merkleTreePDA)
buildMerkleTreeFromRelay(relayUrl)
```

## Fee constants

```typescript
FIXED_FEE_LAMPORTS      // 5_000_000
VARIABLE_FEE_NUMERATOR  // 3
VARIABLE_FEE_DENOMINATOR// 1000
MIN_DEPOSIT_LAMPORTS    // 10_000_000
VARIABLE_FEE_RATE       // 0.003

calculateFee(amount: number)
calculateFeeBigint(amount: bigint)
getDistributableAmount(amount: number)
```

## Error utilities

```typescript
CloakError
ShieldPoolErrors
RootNotFoundError
isRootNotFoundError(error)
parseError(error)
parseTransactionError(error)
```

Detailed usage: [Error Handling](/sdk/error-handling)

## Versioned exports

```typescript
VERSION            // "2.0.0"
CLOAK_PROGRAM_ID   // mainnet program constant
```

## Protocol and service docs

- [Protocol Architecture](/protocol/architecture)
- [Shield Pool Program](/protocol/shield-pool)
- [Relay API](/services/relay-api)
